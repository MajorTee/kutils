buildscript {
	ext.kotlin_version = '1.1.1'

	repositories {
		mavenCentral()
		maven { url "http://dl.bintray.com/arturbosch/code-analysis" }
		jcenter()
	}
	dependencies {
		classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
	}
}

plugins {
	id "com.jfrog.bintray" version "1.7.3"
	id "io.gitlab.arturbosch.detekt" version "1.0.0.M10.2"
}

apply plugin: 'maven'
apply plugin: 'maven-publish'
apply plugin: 'kotlin'

group 'io.gitlab.arturbosch'
version '0.1.5'

uploadArchives {
	repositories {
		mavenDeployer {
			repository(url: uri('../repo'))
		}
	}
}

repositories {
	mavenCentral()
}

dependencies {
	compile "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"
	compile "org.jetbrains.kotlin:kotlinx-stdlib:$kotlin_version"
	testCompile "org.jetbrains.kotlin:kotlin-test:$kotlin_version"
	testCompile "junit:junit:4.12"
}

detekt {
	version = "1.0.0.M10.1"
	input = "$input/src/main/kotlin"
	config = "$project.projectDir/../detekt/default-detekt-config.yml"
	debug = true
}

bintray {
	user = System.getenv("BINTRAY_USER") ?: ""
	key = System.getenv("BINTRAY_API_KEY") ?: ""
	publications = ["kutils"]

	pkg {
		repo = 'generic'
		name = 'kutils'
		userOrg = 'arturbosch'
		licenses = ['Apache-2.0']
		vcsUrl = "https://github.com/arturbosch/kutils"

		version {
			name = project.version
			released = new Date()
		}
	}
}

publishing {
	publications {
		kutils(MavenPublication) {
			from components.java
			groupId project.group
			artifactId project.name
			version project.version
		}
	}
}
